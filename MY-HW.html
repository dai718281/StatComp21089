<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>MY-HW</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">MY-HW</h1>



<div id="hw1" class="section level2">
<h2>HW1</h2>
<p>3.4</p>
<p>从上到下，从左至右的<span class="math inline">\(\sigma\)</span>参数值分别为1，2，3，4</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i<span class="sc">&lt;=</span><span class="dv">4</span>) {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">11</span>,<span class="fl">0.001</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(y<span class="sc">/</span>sigma[i]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma[i]<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><br />
</p>
<p>3.11</p>
<p><span class="math inline">\(z1,z2,z3,z4\)</span>的<span class="math inline">\(p\)</span>参数值分别为0.75,0.625,0.5,0.375</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.75</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>z1<span class="ot">&lt;-</span>p1<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>x2</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fl">0.625</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>z2<span class="ot">&lt;-</span>p2<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p2)<span class="sc">*</span>x2</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>z3<span class="ot">&lt;-</span>p3<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p3)<span class="sc">*</span>x2</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">&lt;-</span><span class="fl">0.375</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>z4<span class="ot">&lt;-</span>p4<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p4)<span class="sc">*</span>x2</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1,2))</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z1);<span class="fu">hist</span>(z2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z3);<span class="fu">hist</span>(z4)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以观察到当<span class="math inline">\(p=0.5\)</span>时出现比较明显的双峰图形<br />
</p>
<p>3.20</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lamda<span class="ot">&lt;-</span><span class="dv">4</span>   <span class="co">#let lambda=4</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fl">1e5</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e5</span>) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">*</span>lamda)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  n[i]<span class="ot">&lt;-</span><span class="fu">sum</span>(Y)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(n),<span class="fu">var</span>(n))  <span class="co">#The estimate the mean and the variance of X(10)</span></span></code></pre></div>
<pre><code>## [1] 49.99812 75.06400</code></pre>
<p>这与题目中给出的公式所算出的理论值<span class="math inline">\(E[X(10)]=50,Var[X(10)]=75\)</span>相符<br />
改变上述程序中<span class="math inline">\(\lambda\)</span>的取值，可以获得与理论相符的结果</p>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<p>5.4</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>pbeta33<span class="ot">&lt;-</span>beta33<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,x[i])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  beta33[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="dv">30</span><span class="sc">*</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x[i])  <span class="co">#the estimate of F(x)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  pbeta33[i]<span class="ot">&lt;-</span><span class="fu">pbeta</span>(x[i],<span class="dv">3</span>,<span class="dv">3</span>) <span class="co">#the true value of F(x)</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(beta33,<span class="dv">5</span>) <span class="co">#the estimate of F(x) for x=0.1,0.2,...,0.9</span></span></code></pre></div>
<pre><code>## [1] 0.00856 0.05787 0.16305 0.31739 0.50003 0.68271 0.83711 0.94198 0.99106</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pbeta33 <span class="co">#the true value of F(x) for x=0.1,0.2,...,0.9</span></span></code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
<p>5.9</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co">#the sigma value of Rayleigh density is 2</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="fl">1e5</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="fl">1e5</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(x1,x2)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span>x<span class="sc">/</span>sigma1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma1<span class="sc">^</span><span class="dv">2</span>)) <span class="co">#y1 are the sample of iid X1,X2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span>x1<span class="sc">/</span>sigma1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x1<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma1<span class="sc">^</span><span class="dv">2</span>))<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>x1)<span class="sc">/</span>sigma1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>x1)<span class="sc">*</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma1<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#y2 are the sample of X1 and are generated by antithetic variable</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(y1),<span class="fu">sd</span>(y2)) <span class="co">#the variance of y1 and y2</span></span></code></pre></div>
<pre><code>## [1] 0.056239235 0.007738275</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(y2)<span class="sc">/</span><span class="fu">sd</span>(y1) </span></code></pre></div>
<pre><code>## [1] 0.1375957</code></pre>
<p>5.13</p>
<p>Let <span class="math inline">\(f_1=xe^{1/2-x^2/2}\)</span> and <span class="math inline">\(f_2=1/3x^3e^{1/2-x^2/2}\)</span> that are supported on <span class="math inline">\((1,+\infty)\)</span> and are ‘close’ to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1\)</span>.</p>
<p>Thus we get <span class="math inline">\(\hat\theta_1=\frac1m\sum_{i=1}^m\frac{g(X_i)}{f_1(X_i)}\)</span> where <span class="math inline">\(X_i\)</span> has pdf/pmf <span class="math inline">\(f_1\)</span> and <span class="math inline">\(\hat\theta_2=\frac1m\sum_{i=1}^m\frac{g(X_i)}{f_2(X_i)}\)</span> where <span class="math inline">\(X_i\)</span> has pdf/pmf <span class="math inline">\(f_2\)</span> as 2 estimates of <span class="math inline">\(\theta\)</span>.</p>
<p>The variance of <span class="math inline">\(\hat\theta_1=\frac1mvar\frac{g(X_1)}{f_1(X_1)}=\frac1mvar(\frac{x}{\sqrt{2\pi}}e^{-\frac12})=\frac{varx}{2\pi me}=\frac{\int x^3e^{1/2-x^2/2}dx-(\int x^2e^{1/2-x^2/2}dx)^2}{2\pi me}\)</span></p>
<p>and the variance of <span class="math inline">\(\hat\theta_2=\frac1mvar\frac{g(X_1)}{f_2(X_1)}=\frac1mvar(\frac{e^{-\frac12}}{\sqrt{2\pi}x})=\frac{9var\frac1x}{2\pi me}=\frac{\int 3xe^{1/2-x^2/2}dx-(\int x^2e^{1/2-x^2/2}dx)^2}{2\pi me}.\)</span></p>
<p>Then <span class="math inline">\(\hat\theta_1-\hat\theta_2=\int_1^\infty (x^3-3x)e^{1/2-x^2/2}dx=0\)</span></p>
<p>Thus the two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> have equal variance.</p>
<p>5.14</p>
<p>According to 5.13,<span class="math inline">\(f_1=xe^{1/2-x^2/2}\)</span> can be the importance function to close to <span class="math inline">\(g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1\)</span>.</p>
<p>Then <span class="math inline">\(\theta=\int_1^\infty \frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span> can be estimated with <span class="math inline">\(\hat\theta=\frac1m\sum_{i=1}^m\frac{g(X_i)}{f_1(X_i)}=\frac1m\sum_{i=1}^m \frac{X_i}{\sqrt{2\pi e}}\)</span>,where <span class="math inline">\(X_i\)</span> has i.i.d pdf <span class="math inline">\(f_1,i=1,2,3,...,m\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="fl">1e5</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">log</span>(u)) <span class="co">#x&gt;1 has pdf f1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>theta</span></code></pre></div>
<pre><code>## [1] 0.4002112</code></pre>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<p>6.5</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span>;m<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(<span class="dv">20</span>,<span class="dv">2</span>) <span class="co">#generate 20 random numbers of chi-square distribution of df 2</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  CIInf<span class="ot">&lt;-</span><span class="fu">t.test</span>(x)[<span class="dv">4</span>]<span class="sc">$</span>conf.int[<span class="dv">1</span>] <span class="co">#get t-test`s lower bound of CI</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  CISup<span class="ot">&lt;-</span><span class="fu">t.test</span>(x)[<span class="dv">4</span>]<span class="sc">$</span>conf.int[<span class="dv">2</span>] <span class="co">#get t-test`s upper bound of CI</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  a[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(CIInf<span class="sc">&lt;=</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="dv">2</span><span class="sc">&lt;=</span>CISup) <span class="co">#if CIInf&lt;=2&lt;=CISup,a[i]=1,else a[i]=0</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(a) <span class="co"># output the coverage probability of the t-interval</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The t-interval result are more robust to departures from normality than the interval result for variance in Example 6.4</p>
<p>6.A</p>
<p>where the sampled population is chi-square(1),by running the following R-code,we can get the TIe:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span>;n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e5</span>;mu<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>rejectnumber<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,mu) <span class="co">#generate n random numbers of chi-square distribution of df mu</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  pvalue<span class="ot">&lt;-</span><span class="fu">t.test</span>(x,<span class="at">mu=</span><span class="dv">1</span>)[<span class="dv">3</span>] <span class="co">#get p-value of the t-test of x where mu=1</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  rejectnumber[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(pvalue<span class="sc">&lt;=</span>alpha) <span class="co">#if pvalue&lt;=alpha,</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rejectnumber[i]=1,else rejectnumber[i]=0</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>TIe<span class="ot">&lt;-</span><span class="fu">mean</span>(rejectnumber) <span class="co">#the Type I error rate</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>TIe</span></code></pre></div>
<pre><code>## [1] 0.10601</code></pre>
<p>Similarly,where the sampled population is U(0,2) and exp(1),TIe are</p>
<pre><code>## [1] 0.05185</code></pre>
<pre><code>## [1] 0.08255</code></pre>
<p>2</p>
<p>(1)The hypothesis is {<span class="math inline">\(H_0:\mu_1-0.05=\mu_2-0.05=0 \leftarrow\rightarrow H_1=\bar{H_0}\)</span>},where <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> are powers from two different methods.</p>
<p>(2)For the hypothesis test problem,we should use paired-t test because the powers for two methods under a particular simulation setting maybe not independent. But <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> have the same variance and they are both asymptotic normal distribution (CLT) because they are under the same simulation.</p>
<p>(3)For hypothesis testing,we need sample data from each methods to calculate their powers.For example,if we use method I,we need m groups experimental data and each of them include n data,so that we obtain m powers for hypothesis testing.And method II so do.</p>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<p>6.8</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span>;m<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="fu">qchisq</span>(.<span class="dv">95</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>) <span class="co">#critical value for the skewness test</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>sktests<span class="ot">&lt;-</span><span class="fu">numeric</span>(m);p.reject<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#compute b_1d</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>b_1d<span class="ot">&lt;-</span> <span class="cf">function</span>(x,j) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  xbar<span class="ot">&lt;-</span><span class="fu">colMeans</span>(x)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">numeric</span>(n[j])</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n[j]) {</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    a[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(((x[i,]<span class="sc">-</span>xbar)<span class="sc">%*%</span><span class="fu">ginv</span>(<span class="fu">cov</span>(x,x))<span class="sc">%*%</span><span class="fu">t</span>((x<span class="sc">-</span>xbar)))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(a)) <span class="co">#b_1d=mean(a)</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#compute p.reject for every n[i]</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#generate matrix x where x[i,] are norm(0,1) r.v.</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n[j]<span class="sc">*</span>d),<span class="at">nrow=</span>n[j],<span class="at">ncol=</span>d)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    sktests[i]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(n[j]<span class="sc">*</span><span class="fu">b_1d</span>(x,j)<span class="sc">/</span><span class="dv">6</span><span class="sc">&gt;=</span>cv)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  p.reject[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<p>Because the skewness of chisquared with d(d + 1)(d + 2)/6 degrees of freedom is not 0, p-value should be small to reject <span class="math inline">\(H_0\)</span>. And the result of p.reject above is consistent.</p>
<p>6.10</p>
<p>To improve operational efficiency,we use n[3]=30 as n:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>), <span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">length</span>(epsilon)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>pwr<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#x &lt;- rnorm(n,0,sigma)</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n[<span class="dv">3</span>]<span class="sc">*</span>d,<span class="dv">0</span>,sigma),<span class="at">nrow=</span>n[<span class="dv">3</span>],<span class="at">ncol=</span>d)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(n[<span class="dv">3</span>]<span class="sc">*</span><span class="fu">b_1d</span>(x,<span class="dv">3</span>)<span class="sc">/</span><span class="dv">6</span><span class="sc">&gt;=</span> cv)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) <span class="co">#add standard errors</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>When <span class="math inline">\(\epsilon\rightarrow0\)</span> or <span class="math inline">\(1\)</span>,model is normal, so that p should be similar with 6.8. Else model is not normal, then p will be larger.</p>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<p>7.7</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap);<span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values  <span class="co">#eigenvalues of cov(scor)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span>eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalues) <span class="co">#the true theta</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e3</span>;thetahat<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#bootstrap to compute theta_star</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">88</span>,<span class="dv">88</span>,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  scorhat<span class="ot">&lt;-</span>scor[x,]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  eigenvalueshat<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scorhat))<span class="sc">$</span>values</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  thetahat[i]<span class="ot">&lt;-</span>eigenvalueshat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalueshat)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>thetastar<span class="ot">&lt;-</span><span class="fu">mean</span>(thetahat)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span>theta<span class="sc">-</span>thetastar,<span class="at">se=</span><span class="fu">sd</span>(thetahat)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##     bias       se 
## -0.00217  0.04550</code></pre>
<p>7.8</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap);<span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span>eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalues)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>scorhat<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">87</span>,<span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>thetahat<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">88</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">88</span>) {</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Jackknife to compute theta_star</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  scorhat<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  eigenvalueshat<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scorhat))<span class="sc">$</span>values</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  thetahat[i]<span class="ot">&lt;-</span>eigenvalueshat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalueshat)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>thetastar<span class="ot">&lt;-</span><span class="fu">mean</span>(thetahat);se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">87</span><span class="sc">*</span><span class="fu">mean</span>((thetahat<span class="sc">-</span><span class="fu">mean</span>(thetahat))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="dv">87</span><span class="sc">*</span>(theta<span class="sc">-</span>thetastar),<span class="at">se=</span>se),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##     bias       se 
## -0.00107  0.04955</code></pre>
<p>7.9</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap);<span class="fu">library</span>(boot)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span>;<span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))<span class="sc">$</span>values</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span>eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigenvalues)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>boot.theta<span class="ot">&lt;-</span> <span class="cf">function</span>(data,i) {</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  boot.eigenvalues<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(data[i,]))<span class="sc">$</span>values</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  boot.theta<span class="ot">&lt;-</span>boot.eigenvalues[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(boot.eigenvalues)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(boot.theta)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>scor,<span class="at">statistic=</span>boot.theta, <span class="at">R =</span><span class="fl">1e4</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;perc =&#39;</span>,ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],<span class="st">&#39;BCa =&#39;</span>,ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>## perc = 0.5229717 0.7097254 BCa = 0.5206088 0.7071371</code></pre>
<p>There are confidence interval inf and sup of percentile and BCa methods.</p>
<p>7.B</p>
<p>For normal populations,we should compare the sample datas to 0,where is the skewness of nrom(0,1):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e2</span>;m<span class="ot">&lt;-</span><span class="fl">1e3</span>;<span class="fu">library</span>(boot);<span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>boot.skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(((x[i]<span class="sc">-</span><span class="fu">mean</span>(x[i]))<span class="sc">/</span><span class="fu">sd</span>(x[i]))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>U,<span class="at">statistic=</span>boot.skewness, <span class="at">R =</span><span class="fl">1e3</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span><span class="dv">0</span>))</span></code></pre></div>
<p>The skewness of chisq with df 5 is<br />
<span class="math display">\[E(\frac{X-\mu}{\sigma})^3=\frac{EX^3-3\mu\sigma^2-\mu^3}{\sigma^3}=\frac{40}{10^{3/2}}&gt;0.\]</span> R-code is similar to the normal population situation:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">40</span><span class="sc">/</span><span class="dv">10</span><span class="sc">^</span><span class="fl">1.5</span>;n<span class="ot">&lt;-</span><span class="fl">1e2</span>;m<span class="ot">&lt;-</span><span class="fl">1e3</span>;<span class="fu">library</span>(boot);<span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>boot.skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(((x[i]<span class="sc">-</span><span class="fu">mean</span>(x[i]))<span class="sc">/</span><span class="fu">sd</span>(x[i]))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">5</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>U,<span class="at">statistic=</span>boot.skewness, <span class="at">R =</span><span class="fl">1e3</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu))</span></code></pre></div>
<p>We can find the coverage rates is less than the normal populations.</p>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="exercise-8.2" class="section level5">
<h5>Exercise 8.2</h5>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data set from chickwts of R-studio</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;casein&quot;</span>])</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span></code></pre></div>
<p>The figure of linseed v.s. casein is:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e3</span>;K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z);n<span class="ot">&lt;-</span><span class="fu">length</span>(x);<span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]; y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1,y1,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(p,<span class="fu">cor.test</span>(x,y,<span class="at">method =</span> <span class="st">&#39;spearman&#39;</span>)<span class="sc">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.568 0.573</code></pre>
</div>
<div id="exercise-2" class="section level5">
<h5>exercise 2</h5>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN);<span class="fu">library</span>(boot);<span class="fu">library</span>(Ball);<span class="fu">library</span>(energy)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Tn function to compute the proportion of the first through Kth NN coincidences</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z);</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;=</span> n1); i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1) </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">#eqdist.nn function to compute the p.value of NN-method</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z,sizes,k){</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic=</span>Tn,<span class="at">R=</span>R,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0,boot.obj<span class="sc">$</span>t)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>ts[<span class="dv">1</span>],<span class="at">p.value=</span>p.value)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fl">1e3</span>; R<span class="ot">&lt;-</span><span class="fl">1e3</span>; k<span class="ot">&lt;-</span> <span class="dv">2</span>; alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>; <span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">20</span>; p<span class="ot">&lt;-</span><span class="dv">3</span>;n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">3</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span>(m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x obey N(0,1),y obey N(0,1.5)</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>         x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p),<span class="at">ncol=</span>p)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>         y <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="at">ncol=</span>p)</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x obey N(1,2),y obey N(2,3)</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">2</span>) {</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>         x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span>p)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>         y <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">ncol=</span>p)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Non-normal distributions:</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x obey t(1),y obey  bimodel distribution (mixture of N(0,1) and N(2,3) with probability 0.3 and 0.7 respectively)</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">3</span>) {</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>         r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n2<span class="sc">*</span>p,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>         x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>p,<span class="dv">1</span>),<span class="at">ncol=</span>p)</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>         y <span class="ot">&lt;-</span><span class="fu">matrix</span>(r<span class="sc">*</span><span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span><span class="fu">rnorm</span>(n2<span class="sc">*</span>p,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">ncol=</span>p)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#Unbalanced samples:</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>      <span class="co">#x,y iid obey N(0,1) where x has 10 sanples and y has 30</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> {</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>         n1 <span class="ot">&lt;-</span> <span class="dv">10</span>;n2 <span class="ot">&lt;-</span> <span class="dv">30</span>;n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2; N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>         x <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p),<span class="at">ncol=</span>p)</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>         y <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p),<span class="at">ncol=</span>p)</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>      z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>      p.values[m,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z,N,k)<span class="sc">$</span>p.value</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>      p.values[m,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R=</span>R)<span class="sc">$</span>p.value</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>      p.values[m,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations=</span>R,<span class="at">seed=</span>m<span class="sc">*</span><span class="dv">2</span>)<span class="sc">$</span>p.value</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cat</span>(<span class="st">&#39;The answer of&#39;</span>,i,<span class="st">&#39;is:&#39;</span>,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cat</span>(<span class="st">&#39;nn=&#39;</span>,<span class="fu">mean</span>(p.values[,<span class="dv">1</span>]<span class="sc">&lt;</span>alpha),</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;energy=&#39;</span>,<span class="fu">mean</span>(p.values[,<span class="dv">2</span>]<span class="sc">&lt;</span>alpha),</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;ball-methods=&#39;</span>,<span class="fu">mean</span>(p.values[,<span class="dv">3</span>]<span class="sc">&lt;</span>alpha),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The result shows energy-method is better than nn-method in most cases,and ball-method sometimes can be better than energy-method.</p>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<p>9.3</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span>;R<span class="ot">&lt;-</span><span class="dv">4</span>;sigma<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>);k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> R,<span class="at">ncol =</span> m);Y[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#generate MC</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,Y[r,i<span class="dv">-1</span>],sigma[r])</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">dt</span>(y,<span class="at">df=</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">dt</span>(Y[r,i<span class="dv">-1</span>],<span class="at">df=</span><span class="dv">1</span>)){</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    Y[r,i] <span class="ot">&lt;-</span> y   <span class="co">#y is accept</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    Y[r,i] <span class="ot">&lt;-</span> Y[r,i<span class="dv">-1</span>]  <span class="co">#y is rejected</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    k[r] <span class="ot">&lt;-</span> k[r]<span class="sc">+</span><span class="dv">1</span>      <span class="co">#compute the number of rejection</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here are four different chains with indicators ranging from 8000 to 8500 where unnecessary code is hidden:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen from the above figure, the smaller the variance, the faster the convergence of the chain,and conversely,the slower.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>     <span class="co">#discard the first 1000 sample</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Ycut <span class="ot">&lt;-</span> Y[,(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, <span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), .<span class="dv">95</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>QSample<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> R,<span class="at">ncol =</span> <span class="fu">length</span>(a))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>QSCD <span class="ot">&lt;-</span> <span class="fu">qt</span>(a,<span class="at">df=</span><span class="dv">1</span>)  <span class="co">#true quantiles of standard Cauchy distribution</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  QSample[r,] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Ycut[r,], a) <span class="co">#sample quantiles of discard the first 1000 of the chain</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#make table of quantiles</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>tableQ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(QSCD,QSample[<span class="dv">1</span>,],</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                      QSample[<span class="dv">2</span>,],QSample[<span class="dv">3</span>,],QSample[<span class="dv">4</span>,]), <span class="dv">5</span>))</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tableQ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;Sigma=1&#39;</span>,<span class="st">&#39;Sigma=3&#39;</span>,<span class="st">&#39;Sigma=5&#39;</span>,<span class="st">&#39;Sigma=7&#39;</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tableQ,<span class="st">&#39;pipe&#39;</span>)</span></code></pre></div>
<p>We can conclude that the greater the variance, the better the better the quantile fitting effect.</p>
<p>9.8</p>
<p>The bivariate density is <span class="math inline">\(f(x,y)\propto{n \choose x}y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,...,n,0\leq y\leq 1\)</span>. It can be shown that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are <span class="math inline">\(x\sim b(n,y)\)</span> and <span class="math inline">\(y\sim \beta(x+a,n−x+b)\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>);N <span class="ot">&lt;-</span> <span class="fl">1e4</span>;burn <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">4</span>;b<span class="ot">&lt;-</span><span class="dv">4</span>;n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>Z[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>), <span class="fu">runif</span>(<span class="dv">1</span>)) <span class="co">#initialize</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Z[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>Z[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Z[i, <span class="dv">1</span>]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>Z[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>((<span class="dv">8</span><span class="sc">*</span>burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),Z[(<span class="dv">8</span><span class="sc">*</span>burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>((<span class="dv">8</span><span class="sc">*</span>burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),Z[(<span class="dv">8</span><span class="sc">*</span>burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(x),<span class="fu">expression</span>(y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be seen from the above figure that the difference between x and y is obvious, and x fluctuates greatly, while y is relatively stable.</p>
<p>Question 2</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The following figure shows the chain of four different parameters with the number of iterations from 4000 to 10000 where unnecessary code is hidden.when Sigma is 3 or 5,the convergence effect is good.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYil+Y6AAA6ADo6AGY6Ojo6OmY6ZmY6ZrY6kNth0E9mAABmADpmOgBmOjpmZjpmZmZmZpBmtrZmtv+QOgCQZgCQZmaQkGaQtraQttuQ2/+2ZgC2Zjq2tma2tpC2tra2ttu225C229u22/+2/7a2///bkDrbkGbbtrbb/9vb///fU2v/tmb/25D/27b/29v//7b//9v///9rFuvGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAId0lEQVR4nO2djXakNBiG6Wi31aqzs2rr1Kodtf5scXWpTrn/K5MkwPA7LwkJJPA+59jFTpIJT0OAj4REKTlLNHcFfIeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAPUGv95Fk8+yoOv6hJSiOtmojKTaWj46g1/tSS3z5j4PK+IiOoONuX2wmqznI2IIAmn1Q3oTYB/Vw3KmzWG/7iYLBjaCpi3NXAQqylM50j+KesxgF9ZSifWi7wlNBropzVwEKspSOgqwlnKU4dxVwIqi4TBTwLNbF6z26R125oMzQG5vFOWDuPiiJ9mc/X72giYtzVwEKspTOJ0HyJCnOApXI5SBePj+dOhYsSHVvh4tH3YzH3WYVgg7yBAnPky2S2kVZaIKGx/QqZtQhdoiiix8uHl+uv8sOve3LdRTlv62fSJNom4QrSCfomUSFISnokO11EglB2UEXi0YiYlCimcXZL4SvDHU8BixIC7HTcleFoJfrvEd6ud6Kj+SP/fHdY5p/VGEtglL5aDtrFEKQ2ulECNrnTnIxSdS8WF2RoFQeWkJQ3C0ozhrZ7+tsQcWBkznpb0Hl/6ywDyrOYolqQcpX3BAkVbTuB9chKNtv8ThSPLNtnMUaLSi74G481l2JIHWrIQ6a8jpo88vmudUHXTw2r7bXIqgD/UEk0VUOSje4QM0KTFWcbDPHnfYYiaICyFPwgsTlTuuCR78CvYr4ZLXg6qqzMYXfguxWINNTd0RBXVRaEgVZSueTIMOQa1zccWhVIEBBhiFXcVebnDItWJBZyFVeKlUyLVeQaci1kTc0QR/P0EhqHnKVv9HcH08EnfPTFGQccs2uuU93JIEJ0sUs5JplKwduL1xQahRyTSunseUKGhFyrR51yxVkGHJV6U5xo+UKMg25HrJclWlICxZkGnKtXxnNLAjOWZ0/5Go5nd4e4Tmr3oRcbaXT2qMBMw59C7mOTqe1RwPmrK47HjRpCzJk7j4IzVldsqAPD3d/oNR4zurQ73WFM0HHry9ubq4/HTsbfvqQq/qbuY8H/fyT+Pnv3cjp8NOHXF8+q2VwIuj14fbbL24l33x5O8iRgzmrhqNcG+dTN4I+PP169yR5+PHpN4NGZOHJqmnINa4LdXuIvf711dB8A7/37RkaSQ1DroebqBZR7AlXoorChNld1ifXke1O+pyfpiCzkOtxJ86oh+bdvH1Bafrf09OfKLXrm1XDkGs7HgSbULg3q0Yh13ZEsSaoOOjEz4+aFfXmVmNcyLU815eCGg9Q8n/L7im8m1XbIVdwkIXXgoxDrsJrq5OGhHizuoSQ69Q3q6GFXCcsLsiQ66TFmYZcW9efPekGF6hdhSmLM6hA+wq9O93gAo2rMkVxJhWgIFCBc4JO94BrFtQy1HWDvGJB1Sb0VtnpTje4QJtMHpNO8kBd5WYVhVX0KuqPIOM3LwijwQ7i1MD0zQtpLUIemqCrM9RTjhgGLOONPRUYWtHxCY2KO+enOZHLfBjwYSVTMk2HAdfu2JYsKDWMSSfVfn3hglKTmPShGnxZriDjmHQ9JhKl8ull4ylmuV3+dmJBFp+sar95od4liSqUEirVatYvvBZk/OaFWheU1v9E/X+wAAWZxqTr4yiW2wd1wph0L4xJI0IcBjx9ce4qQEGW0lGQtYSzFOeuAhRkKR0FWUs4S3HuKuBI0NQT6vSZV9CAMYqzY3u/dQSFMB1qKE4EhTChbihsQQBXfZD3E+qG4ugs5v+EuqGs9jpoKBQEcC3I20Ugh8IWBKAgQHgPDieGLQhAQQBH92KnQ4lnsS4CWARyKM4CZmgRyGBwIwguAgkL7f9o/k9sJB9d6PwaKMj4ExvJBZW4mX6h82ugIONPbCQXUBCAggAUNBoKWhEUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIYEuQmpudlEvAtzZaiInLb7rT9maKo3wOmc4XjcOSoHxGblZFOce2vdHOkWWQb23RyCReSiEfPOl80UjsCDruonINosObjo0W6pN486yRST227Eza/0VjsSMovvw+E5TPdc9nKtc2WjnK19NqZCoF6XzRWKwIyvZW9EFqp5Osuq2NVpZk834n3ySuk6k4xHTyjMWGING+hSDVB2Q/2xutPPKFN6JJ6GQqemKtPCOxIUgMu9cWdJH/yXUyibcxiDflBCZINm/dQ0x1F+JtE8MznXqcsA6xOB9QstfpO9W+ZPulkalsJsF10ml1qcFhZ181cyjROs2Xbx8P7zSfX0nrXL/FhVGNTEUfFN6FYnGrUa793t5oId49se1O25vpYJBnJLxZBVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/glqDUFwMiZhMBQEoCCAl4KOO7HwoxwzplaCVMPYtmoMmcGCNiPwVJBY+DH7r1hDK1/4cSuHXPW9qtkNngranhakEytBqkYjxjUmm/fvJj3iPBUkl4bal+v4qW5I+jpEDgYinsFrQeVKkJUVnYe9Rc0eXgtqtCDB6/2tg7G+Z/BaULkS5Gm5gfjyb/h2Hqt4LSifvZKfxVRvvXcynr4fvwXVr4PEWs9ydPWU3bR/gjyDggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A8vF4OQ8xSCeQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>MC of 9.3 starts to converge when the number of iterations is about 2000 (the figure discards the first 1000 iterations). The subsequent curve rises as the number of iterations increases, which may be the reason for the random number set.seed().</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">apply</span>(Z, <span class="dv">1</span>, cumsum)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>R-hat of 9.8 MC is always below 1.2 when the number of iterations is between 1000 and 10000. However its subsequent convergence is still difficult to judge,because the curve is increasing. It requires more in-depth research.</p>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
<p>11.3</p>
<p>a,b</p>
<p>Here is a function to calculate the sum of the series, where each item of the series is stored in vector f.It can calculate the sum of infinity,since the remainder less than 1e-40 is discarded.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sumf <span class="ot">&lt;-</span> <span class="cf">function</span>(k,d,a) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="fu">numeric</span>(k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>k) {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>i<span class="sc">/</span>(<span class="fu">factorial</span>(i)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>i)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    x2<span class="ot">&lt;-</span>(<span class="fu">sum</span>(a<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">2</span>)))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    x3<span class="ot">&lt;-</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(i<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(i<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    f[i<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(f[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&lt;=</span><span class="fl">1e-40</span>) <span class="cf">break</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(f))</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>c</p>
<p>Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fl">1e4</span>;d<span class="ot">&lt;-</span><span class="dv">4</span>;a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sumf</span>(k,d,a)</span></code></pre></div>
<pre><code>## [1] 0.6336579</code></pre>
<p>11.5</p>
<p>In order to avoid calculating the integral with unknown parameters in the integral limit, we take the derivation of the left and right sides of the equation: <span class="math inline">\(d(\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du)/da=(\frac{k}{k-a^2})^{-k/2}\frac{dc_{k-1}}{da}=\sqrt{\frac{k-1}{k-a}}(1-\frac{a^2}{k})^{k/2-1}\)</span>,which is defined as der(<span class="math inline">\(\alpha\)</span>,k) in the below R-code</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>cof<span class="ot">&lt;-</span><span class="cf">function</span>(k) {<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(k<span class="dv">-1</span>))}</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>der<span class="ot">&lt;-</span><span class="cf">function</span>(alpha,k) {<span class="fu">sqrt</span>((k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>alpha<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(k<span class="sc">/</span><span class="dv">2-1</span>)}</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>eq<span class="ot">&lt;-</span><span class="cf">function</span>(alpha){</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  eqleft<span class="ot">&lt;-</span><span class="fu">cof</span>(k)<span class="sc">*</span><span class="fu">der</span>(<span class="at">alpha =</span> alpha,<span class="at">k=</span>k)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  eqright<span class="ot">&lt;-</span><span class="fu">cof</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">der</span>(<span class="at">alpha =</span> alpha,<span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  eqleft<span class="sc">-</span>eqright</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(eq,<span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">1.3</span>))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##    root  f.root    iter 
## 0.81941 0.00000 5.00000</code></pre>
<p>It is interesting that the equation has more than one solution. When x takes some points in [-2, 2], we can find it has two zero pionts.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="fl">0.2</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a)) {</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">eq</span>(a[i]))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] NaN
## [1] 0.04136735
## [1] 0.05461151
## [1] 0.04677865
## [1] 0.0316717
## [1] 0.01467258
## [1] -0.001483724
## [1] -0.01522477
## [1] -0.0255967
## [1] -0.03202515
## [1] -0.03420062
## [1] -0.03202515
## [1] -0.0255967
## [1] -0.01522477
## [1] -0.001483724
## [1] 0.01467258
## [1] 0.0316717
## [1] 0.04677865
## [1] 0.05461151
## [1] 0.04136735
## [1] NaN</code></pre>
<p>question2</p>
<p>Observed likelihood: <span class="math inline">\(L_o(\lambda|x^1,x^2)=\prod_{i=1}^7 \lambda e^{-\lambda x_i}\prod_{i=1}^3 P(X&gt;1)=\lambda^7e^{-\lambda\sum_{i=1}^7x_i}e^{-3\lambda}\)</span>,where <span class="math inline">\(x^1\)</span> is the data of <span class="math inline">\(T_i\)</span> which less than 1 and <span class="math inline">\(x^2\)</span> is the data of <span class="math inline">\(T_i\)</span> which more than 1.</p>
<p>Then <span class="math inline">\(\hat{\lambda}=argmax(log(L_o(\lambda|x^1,x^2)))=\frac{7}{\sum_{i=1}^{7}x_i+3}.\)</span></p>
<p><span class="math inline">\(L_c(\lambda|x^1,y)=\prod_{i=1}^7 \lambda e^{-\lambda x_i}\prod_{i=1}^3 \lambda e^{-\lambda y_i}=\lambda^{10}e^{-\lambda(\sum_{i=1}^7x_i+\sum_{i=1}^3y_i)}\)</span>,where <span class="math inline">\(y\)</span> is the data of <span class="math inline">\(T_i\)</span> which more than 1.</p>
<p>Then <span class="math inline">\(\hat{\lambda}=argmax(log(L_c(\lambda|x^1,y)))=\frac{10}{\sum_{i=1}^{7}x_i+\sum_{i=1}^{3}y_i}.\)</span></p>
<p>E-step:</p>
<p><span class="math inline">\(E_{\hat{\lambda_0}}[logL_o(\lambda|x^1,y)|x^1,x^2]=10log\lambda-\lambda\sum_{i=1}^7x_i-3\lambda E_{\hat{\lambda_0}}[y|x^2]\)</span>. <span class="math inline">\(\hat{\lambda_0}\)</span> is a given initial value and <span class="math inline">\(E_{\hat{\lambda_0}}[y|x^2]=\frac{\int_1^{+\infty}\hat{\lambda_0}e^{-\hat{\lambda_0}y}ydy}{\int_1^{+\infty}\hat{\lambda_0}e^{-\hat{\lambda_0}y}dy}=\frac{\hat{\lambda_0}+1}{\hat{\lambda_0}}\)</span>.</p>
<p>M-step:</p>
<p>Let <span class="math inline">\(E_{\hat{\lambda_0}}[logL_o(\lambda|x^1,y)|x^1,x^2]=0\)</span>,it shows that <span class="math inline">\(\hat{\lambda_1}=\frac{10}{\sum_{i=1}^{7}x_i+3\frac{\hat{\lambda_0}+1}{\hat{\lambda_0}}}\)</span></p>
<p>The following R-code show <span class="math inline">\(\hat{\lambda_n}\rightarrow\hat{\lambda}\)</span> when <span class="math inline">\(n\rightarrow +\infty\)</span>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e3</span>;tol <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>yhat<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">0.91</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">7</span><span class="sc">/</span><span class="fu">sum</span>(y);lambdahat<span class="ot">&lt;-</span><span class="fl">1.5</span>;lambdahat.old<span class="ot">&lt;-</span>lambdahat<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  lambdahat<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(yhat)<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>(lambdahat<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>lambdahat)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(lambdahat <span class="sc">-</span> lambdahat.old)<span class="sc">/</span>lambdahat.old) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  lambdahat.old <span class="ot">&lt;-</span> lambdahat</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">list</span>(<span class="at">lambda=</span>lambda, <span class="at">lambdahat =</span> lambdahat, <span class="at">iter =</span> j, <span class="at">bias =</span> tol))</span></code></pre></div>
<pre><code>## $lambda
## [1] 1.037037
## 
## $lambdahat
## [1] 1.037037
## 
## $iter
## [1] 15
## 
## $bias
## [1] 1.490116e-08</code></pre>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
<p>Page 204 exercise 1:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim)),  <span class="co">#code 1</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x))  <span class="co">#code 2</span></span></code></pre></div>
<pre><code>##      [,1]      [,2]     
## [1,] 2.588326  2.588326 
## [2,] 0.3693381 0.3693381
## [3,] 0.2228929 0.2228929
## [4,] 0.1303608 0.1303608</code></pre>
<pre><code>In code 1, it defines a function with parameter trim to calculate the mean of x, where the fraction (0 to 0.5) of observations to be trimmed from each end of x. Then use lapply() to pass each column of trims to f where trim=trims&lt;-c(0, 0.1, 0.2, 0.5) and returns a new list.
In code 2,the function is mean() where its parameter x=x&lt;-rcauchy(100) is a 100 cauchy distribution random numbers list. Then use lapply() to pass each column of trims to mean and returns a new list.</code></pre>
<p>Page 204 exercise 5:</p>
<p>The following code shows the rsq of the four fitting results:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(mpg <span class="sc">~</span> disp,mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                 mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt) <span class="co">#Four fitting formulas</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>lms<span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas,lm,<span class="at">data=</span>mtcars) <span class="co">#Four parameter results of fitting</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared <span class="co">#Four r.squared</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>rsqs<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">lapply</span>(lms,rsq))</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>rsqs</span></code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]      [,4]     
## [1,] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p>Generate ten different bootstrap samples for mpg~disp and calculate their r-squared:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>lms.boot<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps,<span class="cf">function</span>(data) <span class="fu">lm</span>(mpg <span class="sc">~</span> disp,<span class="at">data =</span> data))</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>rsqs<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">lapply</span>(lms.boot,rsq))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>rsqs</span></code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]     
## [1,] 0.7659762 0.8305737 0.7558596 0.6441697 0.6912514 0.7076797 0.7971549
##      [,8]      [,9]      [,10]    
## [1,] 0.6428681 0.6906963 0.7397489</code></pre>
<p>Page 214 exercise 1:</p>
<p>(a)Data frame X has five columns of data, each of them contains 500 random numbers which follows N(0,1)</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">5</span>,<span class="fu">rnorm</span>(<span class="fl">5e2</span>)))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(X,sd,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      X1      X2      X3      X4      X5 
## 1.03144 0.96238 0.99329 1.00192 1.00269</code></pre>
<p>(b)Data frame Y has five columns of data, each of them contains 500 random numbers which are random sample from 1 to 20 and missing value NA:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  funs <span class="ot">&lt;-</span> <span class="fu">c</span>(sd)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(funs, <span class="cf">function</span>(f) <span class="fu">f</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">5</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="cn">NA</span>),<span class="fl">5e2</span>,<span class="at">rep=</span>T)))</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(Y,summary,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="at">sd=</span><span class="dv">0</span>)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5 
## 5.984 5.776 5.770 5.740 5.533</code></pre>
<p>Page 214 exercise 7:</p>
<p>In windows situation,we implement parSapply() as a alternative version of mcsapply():</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="st">&quot;xx&quot;</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">parSapply</span>(cl, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="fu">get</span>(<span class="st">&quot;+&quot;</span>), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1]  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23</code></pre>
<p>Implement mcvapply() will be hard because the initial value is difficult to assume in high-dimensional situations.</p>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
<p>The following figure shows the image of the chain generated with C code in the number of iterations from 8000 to 10000,where <span class="math inline">\(x\sim b(n,y)\)</span> and <span class="math inline">\(y\sim \beta(x+a,n−x+b)\)</span>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>);<span class="fu">library</span>(Rcpp)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span>;a<span class="ot">&lt;-</span><span class="dv">4</span>;b<span class="ot">&lt;-</span><span class="dv">4</span>;n<span class="ot">&lt;-</span><span class="dv">10</span> <span class="co">#Initial value</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;chainR.R&#39;</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;chainC.cpp&#39;</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>chainsC<span class="ot">&lt;-</span><span class="fu">chainC</span>(N,a,b,n);chainsR<span class="ot">&lt;-</span><span class="fu">chainR</span>(N,a,b,n)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#plot part of image</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;-</span>N<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>((<span class="dv">8</span><span class="sc">*</span>burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),chainsC[(<span class="dv">8</span><span class="sc">*</span>burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>((<span class="dv">8</span><span class="sc">*</span>burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),chainsC[(<span class="dv">8</span><span class="sc">*</span>burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(x),<span class="fu">expression</span>(y)),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Plot QQ-plot,the following figure shows that chains generated by C and R have high similarity.The fitting effect of Figure (a) is worse, which may be because x follows a discrete distribution</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#different x generated by C and R respectively</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(chainsC[,<span class="dv">1</span>],chainsR[,<span class="dv">1</span>],<span class="at">ylab =</span> <span class="st">&#39;R_x&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;C_x&#39;</span>,<span class="at">main=</span><span class="st">&#39;(a)&#39;</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co">#different y generated by C and R respectively</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(chainsC[,<span class="dv">2</span>],chainsR[,<span class="dv">2</span>],<span class="at">ylab =</span> <span class="st">&#39;R_y&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;C_y&#39;</span>,<span class="at">main=</span><span class="st">&#39;(b)&#39;</span>)</span></code></pre></div>
<p>The following results shows different time spent by the two programs,where R-code has higher efficiency.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark) <span class="co">#My R version is 4.1.3</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">chainR=</span><span class="fu">chainR</span>(N,a,b,n), <span class="at">chainC=</span><span class="fu">chainC</span>(N,a,b,n))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<p>Conclusion:There is no essential difference between the chains generated by the two programs, but the C chain runs more efficiently.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
